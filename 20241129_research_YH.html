<!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>CNC &#xac00;&#xacf5; &#xb370;&#xc774;&#xd130; &#xae30;&#xbc18; &#xba38;&#xc2e0;&#xb7ec;&#xb2dd; &#xbaa8;&#xb378; &#xad6c;&#xcd95;</title>
            <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only],
.vscode-high-contrast:not(.vscode-high-contrast-light) img[src$=\#gh-light-mode-only],
.vscode-high-contrast-light img[src$=\#gh-dark-mode-only] {
	display: none;
}

</style>
            
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item {
    list-style-type: none;
}

.task-list-item-checkbox {
    margin-left: -20px;
    vertical-align: middle;
    pointer-events: none;
}
</style>
<style>
:root {
  --color-note: #0969da;
  --color-tip: #1a7f37;
  --color-warning: #9a6700;
  --color-severe: #bc4c00;
  --color-caution: #d1242f;
  --color-important: #8250df;
}

</style>
<style>
@media (prefers-color-scheme: dark) {
  :root {
    --color-note: #2f81f7;
    --color-tip: #3fb950;
    --color-warning: #d29922;
    --color-severe: #db6d28;
    --color-caution: #f85149;
    --color-important: #a371f7;
  }
}

</style>
<style>
.markdown-alert {
  padding: 0.5rem 1rem;
  margin-bottom: 16px;
  color: inherit;
  border-left: .25em solid #888;
}

.markdown-alert>:first-child {
  margin-top: 0
}

.markdown-alert>:last-child {
  margin-bottom: 0
}

.markdown-alert .markdown-alert-title {
  display: flex;
  font-weight: 500;
  align-items: center;
  line-height: 1
}

.markdown-alert .markdown-alert-title .octicon {
  margin-right: 0.5rem;
  display: inline-block;
  overflow: visible !important;
  vertical-align: text-bottom;
  fill: currentColor;
}

.markdown-alert.markdown-alert-note {
  border-left-color: var(--color-note);
}

.markdown-alert.markdown-alert-note .markdown-alert-title {
  color: var(--color-note);
}

.markdown-alert.markdown-alert-important {
  border-left-color: var(--color-important);
}

.markdown-alert.markdown-alert-important .markdown-alert-title {
  color: var(--color-important);
}

.markdown-alert.markdown-alert-warning {
  border-left-color: var(--color-warning);
}

.markdown-alert.markdown-alert-warning .markdown-alert-title {
  color: var(--color-warning);
}

.markdown-alert.markdown-alert-tip {
  border-left-color: var(--color-tip);
}

.markdown-alert.markdown-alert-tip .markdown-alert-title {
  color: var(--color-tip);
}

.markdown-alert.markdown-alert-caution {
  border-left-color: var(--color-caution);
}

.markdown-alert.markdown-alert-caution .markdown-alert-title {
  color: var(--color-caution);
}

</style>
        
        </head>
        <body class="vscode-body vscode-light">
            <p>다음은 두 연구 노트를 합쳐서 요약한 내용입니다. 코드 부분은 그대로 유지하면서 내용을 간략히 정리했습니다.</p>
<hr>
<h2 id="cnc-가공-데이터-기반-머신러닝-모델-구축">CNC 가공 데이터 기반 머신러닝 모델 구축</h2>
<h3 id="1-연구-개요">1. 연구 개요</h3>
<p><strong>연구 목적</strong>: CNC 가공 데이터를 기반으로 머신러닝 모델을 구축하여 제품 품질을 예측하는 시스템 개발<br>
<strong>연구 구성</strong>:</p>
<ul>
<li>데이터 전처리</li>
<li>모델 구축 및 훈련</li>
<li>평가 및 결과 분석</li>
</ul>
<hr>
<h3 id="2-데이터-분석-및-전처리">2. 데이터 분석 및 전처리</h3>
<h4 id="21-데이터셋-구성">2.1 데이터셋 구성</h4>
<ul>
<li><strong>훈련 데이터</strong>: 18,806개
<ul>
<li>양품: 9,403개</li>
<li>불량품: 9,403개 (공정미완료 3,228개, 검사불합격 6,175개)</li>
</ul>
</li>
<li><strong>평가 데이터</strong>: 13,242개 (양품)</li>
</ul>
<h4 id="22-데이터-수집-및-전처리">2.2 데이터 수집 및 전처리</h4>
<pre><code class="language-python">train_sample = pd.read_csv(<span class="hljs-string">&quot;../data/train.csv&quot;</span>, header=<span class="hljs-number">0</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)
path = <span class="hljs-string">r&#x27;../data/CNC Virtual Data set _v2&#x27;</span>
all_files = glob.glob(path + <span class="hljs-string">&quot;/*.csv&quot;</span>)
</code></pre>
<h4 id="23-데이터-라벨링-및-병합">2.3 데이터 라벨링 및 병합</h4>
<pre><code class="language-python">train_sample_np = np.array(train_sample.copy())
train_sample_info = tool_condition(train_sample_np)
train_sample_info = item_inspection(train_sample_info)

<span class="hljs-comment"># 데이터 병합</span>
li_pass = []
li_pass_half = []
li_fail = []
<span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> all_files:
    df = pd.read_csv(filename, index_col=<span class="hljs-literal">None</span>, header=<span class="hljs-number">0</span>)
    <span class="hljs-keyword">if</span> train_sample_info[k, <span class="hljs-number">3</span>] == <span class="hljs-number">0</span>:
        li_pass.append(df)
    <span class="hljs-keyword">elif</span> train_sample_info[k, <span class="hljs-number">3</span>] == <span class="hljs-number">1</span>:
        li_pass_half.append(df)
    <span class="hljs-keyword">else</span>:
        li_fail.append(df)
    k += <span class="hljs-number">1</span>
</code></pre>
<h4 id="24-데이터-정규화-및-분할">2.4 데이터 정규화 및 분할</h4>
<pre><code class="language-python">sc = MinMaxScaler()
X_train = sc.fit_transform(data)
X_train = np.array(X_train)
X_test = sc.fit_transform(data_all)
X_test = np.array(X_test)

Y_train = np.zeros((<span class="hljs-built_in">len</span>(X_train), <span class="hljs-number">1</span>), dtype=<span class="hljs-string">&#x27;int&#x27;</span>)
Y_test = np.zeros((<span class="hljs-built_in">len</span>(X_test), <span class="hljs-number">1</span>), dtype=<span class="hljs-string">&#x27;int&#x27;</span>)
</code></pre>
<hr>
<h3 id="3-딥러닝-모델-설계">3. 딥러닝 모델 설계</h3>
<h4 id="31-모델-아키텍처">3.1 모델 아키텍처</h4>
<pre><code class="language-python">model = Sequential()
model.add(Dense(<span class="hljs-number">128</span>, activation=<span class="hljs-string">&#x27;relu&#x27;</span>, input_dim=<span class="hljs-number">48</span>))
model.add(Dropout(<span class="hljs-number">0.3</span>))
model.add(Dense(<span class="hljs-number">256</span>, activation=<span class="hljs-string">&#x27;relu&#x27;</span>))
model.add(Dropout(<span class="hljs-number">0.3</span>))
model.add(Dense(<span class="hljs-number">512</span>, activation=<span class="hljs-string">&#x27;relu&#x27;</span>))
model.add(Dropout(<span class="hljs-number">0.3</span>))
model.add(Dense(<span class="hljs-number">512</span>, activation=<span class="hljs-string">&#x27;relu&#x27;</span>))
model.add(Dropout(<span class="hljs-number">0.3</span>))
model.add(Dense(<span class="hljs-number">256</span>, activation=<span class="hljs-string">&#x27;relu&#x27;</span>))
model.add(Dropout(<span class="hljs-number">0.3</span>))
model.add(Dense(<span class="hljs-number">128</span>, activation=<span class="hljs-string">&#x27;relu&#x27;</span>))
model.add(Dropout(<span class="hljs-number">0.3</span>))
model.add(Dense(nb_classes, activation=<span class="hljs-string">&#x27;sigmoid&#x27;</span>))
</code></pre>
<h4 id="32-모델-컴파일">3.2 모델 컴파일</h4>
<pre><code class="language-python">model_checkpoint = ModelCheckpoint(<span class="hljs-string">&#x27;weight_CNC_binary.mat&#x27;</span>, monitor=<span class="hljs-string">&#x27;val_acc&#x27;</span>, save_best_only=<span class="hljs-literal">True</span>)
opt = Adam(lr=<span class="hljs-number">1e-4</span>)
model.<span class="hljs-built_in">compile</span>(optimizer=opt, loss=<span class="hljs-string">&#x27;binary_crossentropy&#x27;</span>, metrics=[<span class="hljs-string">&#x27;accuracy&#x27;</span>])
</code></pre>
<hr>
<h3 id="4-실험-결과">4. 실험 결과</h3>
<h4 id="41-모델-훈련">4.1 모델 훈련</h4>
<pre><code class="language-python">history = model.fit(X_train, Y_train, verbose=<span class="hljs-number">2</span>, batch_size=<span class="hljs-number">1024</span>, epochs=<span class="hljs-number">300</span>, validation_split=<span class="hljs-number">0.1</span>, shuffle=<span class="hljs-literal">True</span>, callbacks=[history])
model.save_weights(<span class="hljs-string">&#x27;weight_CNC_binary.mat&#x27;</span>)
model.save(<span class="hljs-string">&quot;CNC_DLL.h5&quot;</span>)
</code></pre>
<h4 id="42-모델-평가">4.2 모델 평가</h4>
<pre><code class="language-python">loss_and_metrics = model.evaluate(X_train, Y_train, batch_size=<span class="hljs-number">32</span>)
<span class="hljs-built_in">print</span>(loss_and_metrics)

loss_and_metrics2 = model.evaluate(X_test, Y_test, batch_size=<span class="hljs-number">32</span>)
<span class="hljs-built_in">print</span>(loss_and_metrics2)
</code></pre>
<h4 id="43-시각화">4.3 시각화</h4>
<pre><code class="language-python">plt.plot(history.history[<span class="hljs-string">&#x27;accuracy&#x27;</span>], label=<span class="hljs-string">&#x27;acc&#x27;</span>)
plt.plot(history.history[<span class="hljs-string">&#x27;val_accuracy&#x27;</span>], label=<span class="hljs-string">&#x27;val_acc&#x27;</span>)
plt.legend()
plt.savefig(<span class="hljs-string">&#x27;accuracy_plot.png&#x27;</span>)
plt.show()

plt.plot(history.history[<span class="hljs-string">&#x27;loss&#x27;</span>], label=<span class="hljs-string">&#x27;loss&#x27;</span>)
plt.plot(history.history[<span class="hljs-string">&#x27;val_loss&#x27;</span>], label=<span class="hljs-string">&#x27;val_loss&#x27;</span>)
plt.legend()
plt.savefig(<span class="hljs-string">&#x27;loss_plot.png&#x27;</span>)
plt.show()
</code></pre>

            
            
        </body>
        </html>